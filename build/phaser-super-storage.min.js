!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PhaserSuperStorage=t():e.PhaserSuperStorage=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){(function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.4+314e4831
 */var r;r=function(){"use strict";function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,i=void 0,s=void 0,a=function(e,t){m[o]=e,m[o+1]=t,2===(o+=2)&&(s?s(y):_())};var c="undefined"!=typeof window?window:void 0,u=c||{},f=u.MutationObserver||u.WebKitMutationObserver,p="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(y,1)}}var m=new Array(1e3);function y(){for(var e=0;e<o;e+=2){(0,m[e])(m[e+1]),m[e]=void 0,m[e+1]=void 0}o=0}var g,v,d,b,_=void 0;function w(e,t){var n=this,r=new this.constructor(I);void 0===r[P]&&R(r);var o=n._state;if(o){var i=arguments[o-1];a(function(){return K(o,r,i,n._result)})}else F(n,r,e,t);return r}function S(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(I);return A(t,e),t}p?_=function(){return t.nextTick(y)}:f?(v=0,d=new f(y),b=document.createTextNode(""),d.observe(b,{characterData:!0}),_=function(){b.data=v=++v%2}):l?((g=new MessageChannel).port1.onmessage=y,_=function(){return g.port2.postMessage(0)}):_=void 0===c?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(y)}:h()}catch(e){return h()}}():h();var P=Math.random().toString(36).substring(2);function I(){}var k=void 0,O=1,N=2,j={error:null};function T(e){try{return e.then}catch(e){return j.error=e,j}}function M(t,n,r){n.constructor===t.constructor&&r===w&&n.constructor.resolve===S?function(e,t){t._state===O?C(e,t._result):t._state===N?E(e,t._result):F(t,void 0,function(t){return A(e,t)},function(t){return E(e,t)})}(t,n):r===j?(E(t,j.error),j.error=null):void 0===r?C(t,n):e(r)?function(e,t,n){a(function(e){var r=!1,o=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,function(n){r||(r=!0,t!==n?A(e,n):C(e,n))},function(t){r||(r=!0,E(e,t))},e._label);!r&&o&&(r=!0,E(e,o))},e)}(t,n,r):C(t,n)}function A(e,t){var n,r;e===t?E(e,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=t),null===n||"object"!==r&&"function"!==r?C(e,t):M(e,t,T(t)))}function x(e){e._onerror&&e._onerror(e._result),L(e)}function C(e,t){e._state===k&&(e._result=t,e._state=O,0!==e._subscribers.length&&a(L,e))}function E(e,t){e._state===k&&(e._state=N,e._result=t,a(x,e))}function F(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+O]=n,o[i+N]=r,0===i&&e._state&&a(L,e)}function L(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,s=0;s<t.length;s+=3)r=t[s],o=t[s+n],r?K(n,r,o,i):o(i);e._subscribers.length=0}}function K(t,n,r,o){var i=e(r),s=void 0,a=void 0,c=void 0,u=void 0;if(i){if((s=function(e,t){try{return e(t)}catch(e){return j.error=e,j}}(r,o))===j?(u=!0,a=s.error,s.error=null):c=!0,n===s)return void E(n,new TypeError("A promises callback cannot return that same promise."))}else s=o,c=!0;n._state!==k||(i&&c?A(n,s):u?E(n,a):t===O?C(n,s):t===N&&E(n,s))}var U=0;function R(e){e[P]=U++,e._state=void 0,e._result=void 0,e._subscribers=[]}var J=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(I),this.promise[P]||R(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?C(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&C(this.promise,this._result))):E(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===k&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===S){var o=T(e);if(o===w&&e._state!==k)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===Y){var i=new n(I);M(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===k&&(this._remaining--,e===N?E(r,n):this._result[t]=n),0===this._remaining&&C(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;F(e,void 0,function(e){return n._settledAt(O,t,e)},function(e){return n._settledAt(N,t,e)})},e}();var Y=function(){function e(t){this[P]=U++,this._result=this._state=void 0,this._subscribers=[],I!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){A(e,t)},function(t){E(e,t)})}catch(t){E(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},e}();return Y.prototype.then=w,Y.all=function(e){return new J(this,e).promise},Y.race=function(e){var t=this;return r(e)?new t(function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},Y.resolve=S,Y.reject=function(e){var t=new this(I);return E(t,e),t},Y._setScheduler=function(e){s=e},Y._setAsap=function(e){a=e},Y._asap=a,Y.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=Y},Y.Promise=Y,Y},e.exports=r()}).call(this,n(3),n(2))},function(e,t,n){"use strict";n.r(t);var r,o=n(0),i=function(){function e(e){void 0===e&&(e=""),this.namespace="",this.forcePromises=!1,this.setNamespace(e)}return Object.defineProperty(e.prototype,"length",{get:function(){return null!==this.getNameSpaceMatches()?this.getNameSpaceMatches().length:0},enumerable:!0,configurable:!0}),e.prototype.key=function(e){var t=this.getNameSpaceMatches()[e],n=this.getCookiesForNameSpace()[t]||null;return this.forcePromises?this.promisefy(n):n},e.prototype.getItem=function(e){var t=this.getCookiesForNameSpace()[e]||null;return this.forcePromises?this.promisefy(t):t},e.prototype.setItem=function(e,t){if(document.cookie=encodeURIComponent(this.namespace+e)+"="+encodeURIComponent(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/",this.forcePromises)return this.promisefy(null)},e.prototype.removeItem=function(e){if(document.cookie=encodeURIComponent(this.namespace+e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",this.forcePromises)return this.promisefy(null)},e.prototype.clear=function(){var e=this.getCookiesForNameSpace();for(var t in e)e.hasOwnProperty(t)&&this.removeItem(t);if(this.forcePromises)return this.promisefy(null)},e.prototype.setNamespace=function(e){if(e&&(this.namespace=e+":",this.reg=new RegExp("^"+this.namespace+"[a-zA-Z0-9]*","g")),this.forcePromises)return this.promisefy(e)},e.prototype.getNameSpaceMatches=function(){var e=this;return decodeURIComponent(document.cookie).split("; ").filter(function(t){return null!==t.match(e.reg)&&t.match(e.reg).length>0})},e.prototype.getCookiesForNameSpace=function(){var e=this,t={};return this.getNameSpaceMatches().forEach(function(n){var r=n.replace(e.namespace,"").split("=");t[r[0]]=r[1]}),t},e.prototype.promisefy=function(e){return new o.Promise(function(t){t(e)})},e}(),s=function(){function e(){this.namespace="",this.keys=[]}return Object.defineProperty(e.prototype,"forcePromises",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),e.prototype.key=function(e){return this.promisefy(this.keys[e])},e.prototype.getItem=function(e){var t=this;return new o.Promise(function(n,r){NativeStorage.getItem(t.namespace+e,function(e){n(e)},function(e){2===e.code?n(null):r(e)})})},e.prototype.setItem=function(e,t){var n=this;if(!(e.length<1))return new o.Promise(function(r,o){NativeStorage.setItem(n.namespace+e,t,function(){n.keys.indexOf(e)<0&&(n.keys.push(e),n.save()),r(null)},function(e){o(e)})});console.error("CordovaStorage: Key cannot be an empty string!")},e.prototype.removeItem=function(e){var t=this;return new o.Promise(function(n,r){NativeStorage.remove(t.namespace+e,function(){var r=t.keys.indexOf(e);r>=0&&(t.keys.splice(r,1),t.save()),n(null)},function(e){r(e)})})},e.prototype.clear=function(){var e=this;return new o.Promise(function(t,n){for(var r=0,o=0;o<e.keys.length;o++)NativeStorage.remove(e.namespace+e.keys[o],function(){++r>=e.keys.length&&(e.keys=[],e.save(),t(null))},function(e){n(e)})})},e.prototype.setNamespace=function(e){var t=this;return void 0===e&&(e=""),this.namespace=e+":",this.keys=[],new o.Promise(function(e){t.load().then(e).catch(e)})},e.prototype.promisefy=function(e){return new o.Promise(function(t){t(e)})},e.prototype.load=function(){var e=this;return new o.Promise(function(t,n){NativeStorage.getItem(e.namespace,function(n){e.keys=JSON.parse(n),t(null)},function(e){n(e)})})},e.prototype.save=function(){NativeStorage.setItem(this.namespace,JSON.stringify(this.keys),function(){},function(){console.warn("CordovaStorage: Failed to save keys of namespace.")})},e}(),a=function(){function e(){}return e.isLocalStorageSupport=function(){try{if("object"==typeof localStorage)return localStorage.setItem("testingLocalStorage","foo"),localStorage.removeItem("testingLocalStorage"),!0}catch(e){return!1}return!1},e.validateMessage=function(e){return e.hasOwnProperty("command")?e:null},e.nameSpaceKeyFilter=function(e,t){return e.filter(function(e){return e.substring(0,t.length)===t})},e}();!function(e){e[e.init=0]="init",e[e.setItem=1]="setItem",e[e.getItem=2]="getItem",e[e.removeItem=3]="removeItem",e[e.clear=4]="clear",e[e.setNamespace=5]="setNamespace",e[e.length=6]="length",e[e.key=7]="key",e[e.error=8]="error"}(r||(r={}));var c=function(){function e(e){void 0===e&&(e=""),this.namespace="",this.forcePromises=!1,this.setNamespace(e)}return Object.defineProperty(e.prototype,"length",{get:function(){var e=Object.keys(localStorage);return a.nameSpaceKeyFilter(e,this.namespace).length},enumerable:!0,configurable:!0}),e.prototype.key=function(e){return this.forcePromises?this.promisefy(this._key,arguments):this._key(e)},e.prototype._key=function(e){var t=Object.keys(localStorage),n=a.nameSpaceKeyFilter(t,this.namespace);return localStorage.getItem(n[e])},e.prototype.getItem=function(e){return this.forcePromises?this.promisefy(this._getItem,arguments):this._getItem(e)},e.prototype._getItem=function(e){return localStorage.getItem(this.namespace+e)},e.prototype.setItem=function(e,t){return this.forcePromises?this.promisefy(this._setItem,arguments):this._setItem(e,t)},e.prototype._setItem=function(e,t){return localStorage.setItem(this.namespace+e,t)},e.prototype.removeItem=function(e){return this.forcePromises?this.promisefy(this._removeItem,arguments):this._removeItem(e)},e.prototype._removeItem=function(e){return localStorage.removeItem(this.namespace+e)},e.prototype.clear=function(){return this.forcePromises?this.promisefy(this._clear,arguments):this._clear()},e.prototype._clear=function(){for(var e=Object.keys(localStorage),t=a.nameSpaceKeyFilter(e,this.namespace),n=0;n<t.length;n++)localStorage.removeItem(t[n])},e.prototype.setNamespace=function(e){return this.forcePromises?this.promisefy(this._setNameSpace,arguments):this._setNameSpace(e)},e.prototype._setNameSpace=function(e){e&&(this.namespace=e+":")},e.prototype.promisefy=function(e,t){var n=this;return new o.Promise(function(r){r(e.apply(n,t))})},e}(),u=function(){function e(e,t){void 0===e&&(e=""),void 0===t&&(t="*"),this.namespace="",this.expectedOrigin="",this.storageLength=0,this.enabled=!1,""!==e&&this.setNamespace(e),this.expectedOrigin=t}return Object.defineProperty(e.prototype,"forcePromises",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.storageLength},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;return this.sendMessage({command:r.init}).then(function(){e.enabled=!0})},e.prototype.key=function(e){return this.sendMessage({command:r.key,value:e})},e.prototype.getItem=function(e){return this.sendMessage({command:r.getItem,key:e})},e.prototype.setItem=function(e,t){return this.sendMessage({command:r.setItem,key:e,value:t})},e.prototype.removeItem=function(e){return this.sendMessage({command:r.removeItem,key:e})},e.prototype.clear=function(){return this.sendMessage({command:r.clear})},e.prototype.setNamespace=function(e){return this.sendMessage({command:r.setNamespace,value:e})},e.prototype.sendMessage=function(e){var t,n=this;e.command===r.init&&(t=!1);var i=new MessageChannel;return new o.Promise(function(o,s){n.enabled||e.command===r.init||s("Messaging not enabled!"),e.command===r.init&&setTimeout(function(){t||s("Unable to get a response in time")},1e3),i.port1.onmessage=function(e){console.log("Frame received message",e);var i=a.validateMessage(e.data);switch(i.command===r.init&&(t=!0),void 0!==i.status&&"ok"===i.status||s(i.value),void 0!==i.length&&(n.storageLength=i.length),i.command){case r.setNamespace:n.namespace=i.value+":",o(i.value);break;case r.getItem:case r.length:case r.key:o(i.value);break;case r.setItem:case r.removeItem:case r.clear:case r.init:o(i.status);break;default:s(i.value)}},(n.enabled||e.command===r.init)&&(console.log("Sending message to parent: ",e),window.parent.postMessage(e,n.expectedOrigin,[i.port2]))})},e}();n.d(t,"CookieStorage",function(){return i}),n.d(t,"CordovaStorage",function(){return s}),n.d(t,"LocalStorage",function(){return c}),n.d(t,"IframeStorage",function(){return u});var f,p=(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(t){var n=e.call(this,t)||this;return n.nameSpace="",a.isLocalStorageSupport()?n.setAdapter(new c):n.setAdapter(new i),n.nameSpace.length>0&&n.storage.setNamespace(n.nameSpace),n}return p(t,e),t.register=function(e){e.register("PhaserSuperStorage",t,"storage")},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.storage=null},t.prototype.setAdapter=function(e){this.storage=e,this.nameSpace.length>0&&this.storage.setNamespace(this.nameSpace)},Object.defineProperty(t.prototype,"forcePromises",{get:function(){return this.storage.forcePromises},set:function(e){this.storage.forcePromises=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return null===this.storage?0:this.storage.length},enumerable:!0,configurable:!0}),t.prototype.setNamespace=function(e){if(this.nameSpace=e,null!==this.storage)return this.storage.setNamespace(e)},t.prototype.key=function(e){return null===this.storage?"":this.storage.key(e)},t.prototype.getItem=function(e){return null===this.storage?null:this.storage.getItem(e)},t.prototype.setItem=function(e,t){if(null!==this.storage)return this.storage.setItem(e,t)},t.prototype.removeItem=function(e){if(null!==this.storage)return this.storage.removeItem(e)},t.prototype.clear=function(){if(null!==this.storage)return this.storage.clear()},t}(Phaser.Plugins.BasePlugin);t.default=l},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,u=[],f=!1,p=-1;function l(){f&&c&&(f=!1,c.length?u=c.concat(u):p=-1,u.length&&h())}function h(){if(!f){var e=a(l);f=!0;for(var t=u.length;t;){for(c=u,u=[];++p<t;)c&&c[p].run();p=-1,t=u.length}c=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function y(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new m(e,t)),1!==u.length||f||a(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}}])});
//# sourceMappingURL=phaser-super-storage.min.js.map